########################################
# Events for Borno
#
# written by Henrik Lohmander
# modified for UU
########################################

namespace = flavor_kbo
normal_or_historical_nations = yes

#The two branches of the Sayfawa dynasty
country_event = {
	id = flavor_kbo.1
	title = flavor_kbo.1.t
	desc = flavor_kbo.1.duu
	picture = BAD_WITH_MONARCH_eventPicture

	mean_time_to_happen = {
		months = 1
	}
	
	trigger = {
		tag = KBO
		NOT = { has_country_flag = kbo_two_branches } #After this flavor_kbo.8 is displayed instead.
	}
	
	
	option = {
		name = flavor_kbo.1.a	#Ok.
		set_country_flag = kbo_two_branches
		add_stability = -1
		add_country_modifier = {
			name = uukbo_dynastic_struggle_modifier
			duration = -1
		}
		set_estate_privilege = estate_nobles_royal_court_tasks
	}
}

#events 2-5 deleted because they're in the MT now

#Reforms of Idris bin Ali
country_event = {
	id = flavor_kbo.6
	title = flavor_kbo.6.t
	desc = flavor_kbo.6.d
	picture = RELIGION_eventPicture

	is_triggered_only = yes #now fired through MT

	option = {
		name = flavor_kbo.6.a	#Reform both the economy and the army.
		ai_chance = { factor = 1 }
		add_mil_power = 50
		custom_tooltip = uukbo_five_janissary
		hidden_effect = {
			if = {
				limit = {
					capital_scope = {
						controlled_by = ROOT 
						has_siege = no
					}
				}
				capital_scope = {
					janissary_infantry = ROOT
					janissary_infantry = ROOT
					janissary_infantry = ROOT
					janissary_infantry = ROOT
					janissary_infantry = ROOT
				}
			} else = {
				random_owned_province = {
					limit = {
						controlled_by = ROOT 
						has_siege = no
					}
					janissary_infantry = ROOT
					janissary_infantry = ROOT
					janissary_infantry = ROOT
					janissary_infantry = ROOT
					janissary_infantry = ROOT
				}
			}	
		}
		add_adm_power = 50
		change_government_reform_progress = 50
	}
	
	option = {
		name = flavor_kbo.6.b	#Focus on the Army.
		ai_chance = { factor = 10 }
		add_army_tradition = 25
		add_mil_power = 75
		custom_tooltip = uukbo_eight_janissary
		hidden_effect = {
			if = {
				limit = {
					capital_scope = {
						controlled_by = ROOT 
						has_siege = no
					}
				}
				capital_scope = {
					janissary_infantry = ROOT
					janissary_infantry = ROOT
					janissary_infantry = ROOT
					janissary_infantry = ROOT
					janissary_infantry = ROOT
					janissary_infantry = ROOT
					janissary_infantry = ROOT
					janissary_infantry = ROOT
				}
			} else = {
				random_owned_province = {
					limit = {
						controlled_by = ROOT 
						has_siege = no
					}
					janissary_infantry = ROOT
					janissary_infantry = ROOT
					janissary_infantry = ROOT
					janissary_infantry = ROOT
					janissary_infantry = ROOT
					janissary_infantry = ROOT
					janissary_infantry = ROOT
					janissary_infantry = ROOT
				}
			}	
		}
	}
	
	option = {
		name = flavor_kbo.6.c	#Focus on the Economy.
		ai_chance = { factor = 1 }
		add_years_of_income = 0.15
		add_adm_power = 75
		change_government_reform_progress = 75
	}
}

#Magira Aisha
country_event = {
	id = flavor_kbo.7
	title = flavor_kbo.7.t
	desc = flavor_kbo.7.d
	picture = RELIGION_eventPicture

	fire_only_once = yes

	trigger = {
		tag = KBO
		has_heir = yes
		has_regency = yes
		OR = {
			has_consort_regency = yes
			NOT = { has_dlc = "Rights of Man" }
		}
		OR = {
			NOT = { mil = 6 }
			NOT = { dip = 6 }
			NOT = { adm = 6 }
		}
		OR = {
			NOT = { heir_mil = 6 }
			NOT = { heir_dip = 6 }
			NOT = { heir_adm = 6 }			
		}
	}
	
	mean_time_to_happen = {
		months = 210
	}
	
	option = {
		name = flavor_kbo.7.a	#Ok.
		ai_chance = { factor = 1 }
		change_adm = 1
		change_heir_adm = 1
		change_dip = 1
		change_heir_dip = 1
		change_mil = 1
		change_heir_mil = 1
	}
}

#The two branches of the Sayfawa dynasty
country_event = {
	id = flavor_kbo.8
	title = flavor_kbo.8.t
	desc = flavor_kbo.8.d
	picture = ACCUSATION_eventPicture

	is_triggered_only = yes
	
	trigger = {
		tag = KBO
		government = monarchy
		has_country_flag = kbo_two_branches
		OR = { #If all these are taken care of this stops.
			NOT = { has_country_flag = kbo_gazargamu }
			NOT = { has_country_modifier = kbo_religious_orthodoxy }
			NOT = { has_country_modifier = kbo_death_to_kingmakers }
		}
	}
	
	
	option = {
		name = flavor_kbo.8.a	#Ok.
		if = {
			limit = {
				NOT = { has_country_flag = kbo_gazargamu }
				NOT = { has_country_modifier = kbo_religious_orthodoxy }
				NOT = { has_country_modifier = kbo_death_to_kingmakers }
			}
			random_owned_province = {
				spawn_rebels = {
					type = pretender_rebels
					size = 3
				}
			}
		} else_if = {
			limit = {
				OR = {
					AND = {
						has_country_flag = kbo_gazargamu
						NOT = { has_country_modifier = kbo_religious_orthodoxy }
						NOT = { has_country_modifier = kbo_death_to_kingmakers }
					}
					AND = {
						has_country_modifier = kbo_religious_orthodoxy
						NOT = { has_country_flag = kbo_gazargamu }
						NOT = { has_country_modifier = kbo_death_to_kingmakers }
					}
					AND = {
						has_country_modifier = kbo_death_to_kingmakers
						NOT = { has_country_flag = kbo_gazargamu }
						NOT = { has_country_modifier = kbo_religious_orthodoxy }
					}
				}
			}
			random_owned_province = {
				spawn_rebels = {
					type = pretender_rebels
					size = 2
				}
			}
		} else_if = {
			limit = {
				OR = {
					AND = {
						has_country_flag = kbo_gazargamu
						has_country_modifier = kbo_religious_orthodoxy
						NOT = { has_country_modifier = kbo_death_to_kingmakers }
					}
					AND = {
						has_country_modifier = kbo_religious_orthodoxy
						has_country_modifier = kbo_death_to_kingmakers
						NOT = { has_country_flag = kbo_gazargamu }
					}
					AND = {
						has_country_modifier = kbo_death_to_kingmakers
						has_country_modifier = kbo_religious_orthodoxy
						NOT = { has_country_modifier = kbo_religious_orthodoxy }
					}
				}
			}
			random_owned_province = {
				spawn_rebels = {
					type = pretender_rebels
					size = 1
				}
			}
		}
	}
}

country_event = {
	id = flavor_kbo.9
	title = flavor_kbo.9.t
	desc = flavor_kbo.9.d
	picture = FAILED_REVOLUTION_eventPicture

	is_triggered_only = yes

	option = {
		name = flavor_kbo.9.a
		set_country_flag = uukbo_dynastic_admin_flag
		custom_tooltip = uukbo_dynastic_admin_tt
	}
	option = {
		name = flavor_kbo.9.b
		set_country_flag = uukbo_meritocratic_admin_flag
		custom_tooltip = uukbo_meritocratic_admin_tt
	}
}

country_event = {
	id = flavor_kbo.10
	title = flavor_kbo.10.t
	desc = flavor_kbo.10.d
	picture = CONQUEST_eventPicture

	is_triggered_only = yes

	option = {
		name = flavor_kbo.10.a
		override_country_name = UUKANEM
	}
	option = {
		name = flavor_kbo.10.b
	}
}

country_event = {
	id = flavor_kbo.11
	title = flavor_kbo.11.t
	desc = flavor_kbo.11.d
	picture = TUAREG_OTTOMAN_eventPicture

	is_triggered_only = yes

	option = { #reform army to have muslim inf
		name = flavor_kbo.11.a
		add_prestige = 10
		set_country_flag = uukbo_can_use_muslim_inf
		custom_tooltip = uukbo_enable_muslim_inf_tt
	}
}